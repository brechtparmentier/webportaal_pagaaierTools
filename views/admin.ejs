<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Webportaal PagaaierTools</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="admin-container">
    <header class="admin-header">
      <h1>Admin Dashboard</h1>
      <div class="admin-user">
        <span>Ingelogd als: <strong><%= username %></strong></span>
        <a href="/admin/logout" class="btn btn-secondary">Uitloggen</a>
      </div>
    </header>

    <nav class="admin-nav">
      <a href="/">‚Üê Home (Publieke View)</a>
      <a href="/admin/projects">üìä Projecten Overzicht (met filters)</a>
      <a href="/admin">üîß Project Beheer</a>
      <a href="/admin/export-json">Exporteer naar JSON</a>
    </nav>

    <main class="admin-main">
      <% if (message) { %>
        <div class="message">
          <%= message %>
        </div>
      <% } %>

      <section class="admin-section">
        <h2>Project Scanner</h2>
        <p>Scan een directory om automatisch projecten te detecteren</p>
        <form method="POST" action="/admin/scan" class="project-form">
          <div class="form-group">
            <label for="scan_path">Pad naar directory</label>
            <input type="text" id="scan_path" name="scan_path" required placeholder="/home/brecht/repos" value="/home/brecht/repos">
            <small>De scanner detecteert automatisch Node.js, Python, Docker projecten</small>
          </div>
          <button type="submit" class="btn btn-primary">Scan Directory</button>
        </form>
      </section>

      <section class="admin-section">
        <h2>JSON Import</h2>
        <p>Importeer projecten van een JSON bestand</p>
        <form method="POST" action="/admin/import-json" class="project-form">
          <div class="form-group">
            <label for="json_data">JSON Data</label>
            <textarea id="json_data" name="json_data" rows="8" placeholder='[{"name": "Project", "directory_path": "/path/to/project", "port": 3000, ...}]' required></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Importeer JSON</button>
        </form>
      </section>

      <section class="admin-section">
        <h2>Nieuw Project Toevoegen</h2>
        <form method="POST" action="/admin/projects/add" class="project-form">
          <div class="form-row">
            <div class="form-group">
              <label for="name">Project Naam</label>
              <input type="text" id="name" name="name" required placeholder="Mijn Project">
            </div>

            <div class="form-group">
              <label for="port">Poort</label>
              <input type="number" id="port" name="port" required placeholder="3001" min="1" max="65535">
            </div>
          </div>

          <div class="form-group">
            <label for="description">Beschrijving</label>
            <input type="text" id="description" name="description" placeholder="Korte beschrijving van het project">
          </div>

          <div class="form-group">
            <label for="directory_path">Directory Pad</label>
            <input type="text" id="directory_path" name="directory_path" required placeholder="/home/brecht/repos/mijn-project">
            <small>Absoluut pad naar de project directory</small>
          </div>

          <button type="submit" class="btn btn-primary">Project Toevoegen</button>
        </form>
      </section>

      <section class="admin-section">
        <h2>Bestaande Projecten</h2>
        <% if (projects.length === 0) { %>
          <p class="no-projects">Geen projecten gevonden.</p>
        <% } else { %>
          <div class="projects-table">
            <table>
              <thead>
                <tr>
                  <th>Naam</th>
                  <th>Beschrijving</th>
                  <th>Directory</th>
                  <th>Poort</th>
                  <th>Status</th>
                  <th>Acties</th>
                </tr>
              </thead>
              <tbody>
                <% projects.forEach(project => { %>
                  <tr class="<%= project.enabled ? '' : 'disabled' %>">
                    <td><strong><%= project.name %></strong></td>
                    <td><%= project.description || '-' %></td>
                    <td><code><%= project.directory_path %></code></td>
                    <td><%= project.port %></td>
                    <td>
                      <span class="status-badge <%= project.enabled ? 'status-active' : 'status-inactive' %>">
                        <%= project.enabled ? 'Actief' : 'Inactief' %>
                      </span>
                    </td>
                    <td class="actions">
                      <a href="/admin/projects/<%= project.id %>/edit" class="btn btn-small btn-primary">Bewerk</a>
                      <form method="POST" action="/admin/projects/<%= project.id %>/toggle" style="display: inline;">
                        <button type="submit" class="btn btn-small btn-secondary">
                          <%= project.enabled ? 'Deactiveren' : 'Activeren' %>
                        </button>
                      </form>
                      <form method="POST" action="/admin/projects/<%= project.id %>/delete" style="display: inline;" onsubmit="return confirm('Weet je zeker dat je dit project wilt verwijderen?');">
                        <button type="submit" class="btn btn-small btn-danger">Verwijder</button>
                      </form>
                    </td>
                  </tr>
                <% }); %>
              </tbody>
            </table>
          </div>
        <% } %>
      </section>
    </main>
  </div>
</body>
</html>
