<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Project Bewerken - Webportaal PagaaierTools</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="admin-container">
    <header class="admin-header">
      <h1>Project Bewerken</h1>
      <div class="admin-user">
        <span>Ingelogd als: <strong><%= username %></strong></span>
        <a href="/admin/logout" class="btn btn-secondary">Uitloggen</a>
      </div>
    </header>

    <nav class="admin-nav">
      <a href="/admin">Terug naar Admin</a>
    </nav>

    <main class="admin-main">
      <% if (error) { %>
        <div class="error-message">
          <%= error %>
        </div>
      <% } %>

      <section class="admin-section">
        <h2><%= project.name %></h2>
        <form method="POST" action="/admin/projects/<%= project.id %>/edit" class="project-form">
          <div class="form-row">
            <div class="form-group">
              <label for="name">Project Naam</label>
              <input type="text" id="name" name="name" required value="<%= project.name %>">
            </div>

            <div class="form-group">
              <label for="port">Poort</label>
              <input type="number" id="port" name="port" required value="<%= project.port %>" min="1" max="65535">
            </div>
          </div>

          <div class="form-group">
            <label for="description">Beschrijving</label>
            <input type="text" id="description" name="description" value="<%= project.description || '' %>">
          </div>

          <div class="form-group">
            <label for="directory_path">Directory Pad</label>
            <input type="text" id="directory_path" name="directory_path" required value="<%= project.directory_path %>">
          </div>

          <div class="form-group">
            <label for="frontend_path">Frontend Pad (bijv. /docs voor FastAPI)</label>
            <input type="text" id="frontend_path" name="frontend_path" value="<%= project.frontend_path || '/' %>" placeholder="/">
            <small style="color: #666;">Laat leeg of "/" voor root. Gebruik "/docs" voor FastAPI Swagger UI.</small>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="setup_type">Setup Type</label>
              <select id="setup_type" name="setup_type">
                <option value="manual" <%= project.setup_type === 'manual' ? 'selected' : '' %>>Manual</option>
                <option value="nodejs" <%= project.setup_type === 'nodejs' ? 'selected' : '' %>>Node.js</option>
                <option value="nextjs" <%= project.setup_type === 'nextjs' ? 'selected' : '' %>>Next.js</option>
                <option value="react" <%= project.setup_type === 'react' ? 'selected' : '' %>>React</option>
                <option value="vue" <%= project.setup_type === 'vue' ? 'selected' : '' %>>Vue</option>
                <option value="python" <%= project.setup_type === 'python' ? 'selected' : '' %>>Python</option>
                <option value="python-flask" <%= project.setup_type === 'python-flask' ? 'selected' : '' %>>Python Flask</option>
                <option value="python-django" <%= project.setup_type === 'python-django' ? 'selected' : '' %>>Python Django</option>
                <option value="python-fastapi" <%= project.setup_type === 'python-fastapi' ? 'selected' : '' %>>Python FastAPI</option>
                <option value="docker" <%= project.setup_type === 'docker' ? 'selected' : '' %>>Docker</option>
                <option value="docker-compose" <%= project.setup_type === 'docker-compose' ? 'selected' : '' %>>Docker Compose</option>
                <option value="pm2" <%= project.setup_type === 'pm2' ? 'selected' : '' %>>PM2</option>
              </select>
            </div>

            <div class="form-group">
              <label for="enabled">
                <input type="checkbox" id="enabled" name="enabled" <%= project.enabled ? 'checked' : '' %>>
                Project Actief
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>URLs (JSON formaat)</label>
            <textarea id="urls" name="urls" rows="10"><%= project.urls || '[]' %></textarea>
            <small>Formaat: [{"type": "main|demo|dev|prod|staging", "url": "http://...", "label": "Optional"}]</small>
          </div>

          <div class="url-preview">
            <h3>Huidige URLs:</h3>
            <% if (project.urlsArray.length === 0) { %>
              <p>Geen URLs geconfigureerd</p>
            <% } else { %>
              <ul>
                <% project.urlsArray.forEach(urlObj => { %>
                  <li>
                    <span class="url-type-badge <%= urlObj.type %>"><%= urlObj.type %></span>
                    <code><%= urlObj.url %></code>
                    <% if (urlObj.label) { %>
                      - <%= urlObj.label %>
                    <% } %>
                  </li>
                <% }); %>
              </ul>
            <% } %>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Project Opslaan</button>
            <a href="/admin" class="btn btn-secondary">Annuleren</a>
          </div>
        </form>
      </section>
    </main>
  </div>

  <script>
    // Auto-format JSON in textarea
    const urlsTextarea = document.getElementById('urls');
    try {
      const parsed = JSON.parse(urlsTextarea.value);
      urlsTextarea.value = JSON.stringify(parsed, null, 2);
    } catch (e) {
      // Ignore parse errors
    }
  </script>
</body>
</html>
