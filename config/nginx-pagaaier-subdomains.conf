# Hoofdportaal - portaal.pagaaier.local
server {
    listen 80;
    listen [::]:80;

    server_name portaal.pagaaier.local;

    # Logs
    access_log /var/log/nginx/portaal_access.log;
    error_log /var/log/nginx/portaal_error.log;

    # Maximum upload size
    client_max_body_size 100M;

    location / {
        # Dit is het webportaal_pagaaierTools project (deze repository)
        # WIJZIG DE POORT NAAR DE POORT WAAROP DIT PORTAAL DRAAIT (waarschijnlijk 3000)
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;

        # WebSocket ondersteuning
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;

        # Headers voor correct IP forwarding
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # Timeouts
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}

# Klasspiegels - klasspiegels.pagaaier.local
server {
    listen 80;
    listen [::]:80;

    server_name klasspiegels.pagaaier.local;

    # Logs
    access_log /var/log/nginx/klasspiegels_access.log;
    error_log /var/log/nginx/klasspiegels_error.log;

    # Maximum upload size
    client_max_body_size 100M;

    location / {
        # Next.js project nextjs_klasspiegelsMVP
        # WIJZIG DE POORT NAAR DE POORT WAAROP KLASSPIEGELS DRAAIT
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;

        # WebSocket ondersteuning (belangrijk voor Next.js hot reload)
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;

        # Headers voor correct IP forwarding
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # Timeouts
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}

# Observatietool - observatie.pagaaier.local
server {
    listen 80;
    listen [::]:80;

    server_name observatie.pagaaier.local;

    # Logs
    access_log /var/log/nginx/observatie_access.log;
    error_log /var/log/nginx/observatie_error.log;

    # Maximum upload size
    client_max_body_size 100M;

    location / {
        # Python Flask project python_rubricsObservatieTool
        # WIJZIG DE POORT NAAR DE POORT WAAROP OBSERVATIE DRAAIT (waarschijnlijk 5000)
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;

        # Headers voor correct IP forwarding
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Host $host;

        # Timeouts
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}

# Fallback voor pagaaier.local (zonder subdomain) en IP-adres
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    server_name pagaaier.local pagaaier 10.46.53.180 _;

    # Logs
    access_log /var/log/nginx/pagaaier_default_access.log;
    error_log /var/log/nginx/pagaaier_default_error.log;

    # Maximum upload size
    client_max_body_size 100M;

    location / {
        # Standaard naar het portaal
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;

        # WebSocket ondersteuning
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;

        # Headers voor correct IP forwarding
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # Timeouts
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}
